# pandas基础练习题目

题目涉及的文件在./data_practice/pandas练习表(多表单).xlsx

如果做题途中发现文件,表格已经混乱不堪,运行下面代码重新建表

```python
# 创建数据
data = {
    "姓名": ["张三", "李四", "王五", "赵六", "钱七", "刘八", "陈九", "周十", "吴十一", "郑十二",
           "李十三", "王十四", "赵十五", "钱十六", "刘十七", "陈十八", "周十九", "吴二十"],
    "性别": ["男", "女", "男", "女", "男", "女", "男", "女", "男", "女",
           "男", "女", "男", "女", "男", "女", "男", "女"],
    "数学": [68, 60, 88, 66, 58, 70, 64, 66, 58, 66,
           64, 58, 98, 58, 64, 66, 58, 66],
    "英语": [64, 66, 58, 90, 88, 58, 66, 70, 95, 58,
           66, 64, 58, 98, 58, 64, 66, 58],
    "物理": [60, 70, 50, 58, 66, 50, 98, 64, 50, 64,
           58, 66, 50, 70, 66, 58, 50, 98],
    "化学": [91, 64, 70, 50, 58, 64, 54, 98, 54, 70,
           50, 58, 64, 58, 98, 50, 58, 66],
    "历史": [50, 54, 58, 64, 54, 98, 50, 66, 58, 58,
           95, 50, 58, 66, 58, 54, 70, 58],
    "地理": [58, 95, 66, 98, 50, 66, 70, 58, 66, 50,
           58, 54, 66, 64, 50, 98, 64, 50]
}
data1 = {
    "姓名": ["张三", "李四", "王五", "赵六", "钱七", "刘八", "陈九", "周十", "吴十一", "郑十二"],
    "年龄": [30, 25, 35, 28, 40, 33, 27, 32, 38, 29],
    "城市": ["北京", "上海", "广州", "深圳", "成都", "重庆", "武汉", "南京", "杭州", "苏州"],
    "性别": ["男", "女", "男", "女", "男", "女", "男", "女", "男", "女"],
    "工作": ["工程师", "医生", "设计师", "教师", "企业家", "程序员", "律师", "音乐家", "演员", "记者"],
    "身高": [175, 163, 180, 168, 185, 170, 178, 160, 172, 165],
    "体重": [70, 55, 75, 60, 80, 65, 72, 58, 68, 62],
    "得分": [85, 92, 78, 88, 91, 75, 83, 89, 80, 86]
}
# 创建数据
data2 = {
    "姓名": ["张三", "李四", "王五", "赵六", "钱七"],
    "年龄": [30, 25, 35, 28, 40],
    "城市": ["北京", "上海", "广州", "深圳", "成都"],
    "性别": ["男", "女", "男", "女", "男"],
    "工作": ["工程师", "医生", "设计师", "教师", "企业家"],
    "月收入": [10000, 12000, 8000, 15000, 20000],
    "收入来源": ["工资", "工资", "兼职", "工资", "投资"],
    "收入日期": ["2024-04-01", "2024-04-05", "2024-04-10", "2024-04-15", "2024-04-20"]
}
# 创建DataFrame
df = pd.DataFrame(data)
df1 = pd.DataFrame(data1)
df2=pd.DataFrame(data2)
# 创建一个Excel写入对象
writer = pd.ExcelWriter('./data_practice/pandas练习表(多表单).xlsx')
# 将第一个数据表写入到第一个工作表中
df.to_excel(writer, sheet_name='学生成绩', index=False)
# 将第二个数据表写入到第二个工作表中
df1.to_excel(writer, sheet_name='个人信息', index=False)
df2.to_excel(writer, sheet_name='收入', index=False)
# 保存Excel文件
writer.save()
```

## 1. 新建一个Excel文件,且包含两个表单

## 2. 分别读取Excel的三个表单的前5行

# 切片练习

## 3. 读取第二个表单指定行

```python
##读取的内容
ammmory  25  深圳  女  设计师  168  55  90
钱七  40  成都  男  企业家  185  80  91
```

## 4. 读取第二个表单指定行区间

```python
####读取内容
ammmory  25  深圳  女  设计师  168  55  90
王五  35  广州  男  设计师  180  75  78
赵六  28  深圳  女   教师  168  60  88
钱七  40  成都  男  企业家  185  80  91
```

## 5. 读取第三个表单指定列

```python
###读取内容
姓名  城市
张三  北京
李四  上海
王五  广州
赵六  深圳
钱七  成都
```

## 6. 读取第三个表单指定列区间

```python
#####读取内容
姓名  年龄  城市
张三  30  北京
李四  25  上海
王五  35  广州
赵六  28  深圳
钱七  40  成都
```

## 7. 读取第一个表单指定行列区间

```python
#####读取内容
赵六  女  66  
钱七  男  58  
刘八  女  70  
```

# 排序练习

## 8. 升降序

```python
####题目要求
读取第一个表单,是学生成绩表
按照数学成绩升/降序排名,对数学进行排序同时,其他列比如性别等需要同步变换
#####升序结果,前5行
     姓名 性别  数学  英语  物理  化学  历史  地理
8   吴十一  男  58  95  50  54  58  66
4    钱七  男  58  88  66  58  54  50
13  钱十六  女  58  98  70  58  66  64
11  王十四  女  58  64  66  58  50  54
16  周十九  男  58  66  50  58  70  64
#####降序结果,前5行
     姓名 性别  数学  英语  物理  化学  历史  地理
12  赵十五  男  98  58  50  64  58  66
2    王五  男  88  58  50  70  58  66
5    刘八  女  70  58  50  64  98  66
0    张三  男  68  64  60  91  50  58
7    周十  女  66  70  64  98  66  58
```

# 增删改

## 9. 增加行

```python
####题目内容
在第三个表单中,李四和王五之间增加一行,内容自定义
1  李四  25  上海  女   医生  12000   工资  2024-04-05
2  王五  35  广州  男  设计师   8000   兼职  2024-04-10
```

## 10. 删除行

```python
####题目内容
在第三个表单中,把刚才增加的一行删除
```

## 11.增加列

```python
#####题目内容
在第三个表单中,性别和工作之间,增加一列,新增一列内容自定义
   姓名  年龄  城市 性别   工作    月收入 收入来源        收入日期
0  张三  30  北京  男  工程师  10000   工资  2024-04-01
1  王五  35  广州  男  设计师   8000   兼职  2024-04-10
2  赵六  28  深圳  女   教师  15000   工资  2024-04-15
3  钱七  40  成都  男  企业家  20000   投资  2024-04-20
```

## 12.删除列

```python
#####题目内容
在第三个表单中,删除收入日期这一列,并重新写入表单中
```

## 13.改数据

```python
#####题目内容
在第一个表单中,把李四的地理从95改成45
     姓名 性别  数学  英语  物理  化学  历史  地理
0    张三  男  68  64  60  91  50  58
1    李四  女  60  66  70  64  54  95
2    王五  男  88  58  50  70  58  66
3    赵六  女  66  90  58  50  64  98
```

# 过滤

## 14.提取满足条件的行

```python
在表单一,将所有性别是男的的提取出来
###结果部分如下
性别为男的行：
     姓名 性别  数学  英语  物理  化学  历史  地理
0    张三  男  68  64  60  91  50  58
2    王五  男  88  58  50  70  58  66
4    钱七  男  58  88  66  58  54  50
```

```python
在上一个基础上,将数学成绩在55到60之间的提取出来
     姓名 性别  数学  英语  物理  化学  历史  地理
4    钱七  男  58  88  66  58  54  50
8   吴十一  男  58  95  50  54  58  66
16  周十九  男  58  66  50  58  70  64
```

## 15.过滤掉空值

```python
在表单一,将含空值的所在行/列删除
```

## 16.提取空值

```python
在表单一,将包含空的所在行/列,单独提取出来
```

# 统计

## 17.统计满足条件的个数

```python
在表单二,统计得分在70到80之间的个数
```

## 18.统计总数

```python
在表单一,统计每个人数学  英语  物理  化学  历史  地理的总分,并写入最后一列(运行最上面的代码,将表单全部重新建)
```

## 19.统计平均数

```python
在表单一,统计每个人求数学  英语  物理  化学  历史  地理的平均数,并加到最后一行
```

## 20.统计满足区间的个数

```python
在表单一,统计数学成绩在0-60,61-70,71-80,81-90,90-100这写区间的人数,并将它们展示出来
```

# 拼接

## 21.拼接两个表单(见题目描述)

```python
#############用./data_practice/拼接练习表.xlsx文件
表单一部分
   姓名 性别  数学  英语  物理
0  张三  男  68  64  60
1  李四  女  60  66  70
2  王五  男  88  58  50
3  赵六  女  66  90  58
4  钱七  男  58  88  66
表单二部分
   姓名 性别  化学  历史  地理
0  张三  男  91  50  58
1  李四  女  64  54  95
2  王五  男  70  58  66
3  赵六  女  50  64  98
4  钱七  男  58  54  50
将他们拼接一起
姓名 性别  数学  英语  物理 化学  历史  地理
张三  男  68  64  60 91  50  58
这样
```

## 22.拼接两个表单(见题目描述)

```python
表单一部分
   姓名 性别  数学  英语  物理
0  张三  男  68  64  60
1  李四  女  60  66  70
2  王五  男  88  58  50
3  赵六  女  66  90  58
4  钱七  男  58  88  66
表单三部分
          姓名 性别   数学   英语   物理
0      amory  男  100  100  100
1  amoryverb  男  100  100  100
将他们拼接一起
   姓名 性别  数学  英语  物理
0  张三  男  68  64  60
1  李四  女  60  66  70
2  王五  男  88  58  50
3  赵六  女  66  90  58
4  钱七  男  58  88  66
5      amory  男  100  100  100
6  amoryverb  男  100  100  100
```

